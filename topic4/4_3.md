---
title: "4.3"
layout: default
---

{% include links.md %}
{% include 4nav.md %}

---

## 4.3
Where Data is Stored  
Weight: 3  

### Lesson 1
- Linux Treats Everything as a File
    - Allows for tweaking of all aspects of the system
    - e.g
        - Programs
        - Regular files
        - Directories
        - Block devices (e.g., hard disks)
        - Character devices (e.g., consoles)
        - Kernel processes
        - Sockets
        - Partitions
        - Links
- Linux Directory Structure
    - Begins from the root `/`
- [Filesystem Hierarchy Standard (FHS)](https://refspecs.linuxfoundation.org/fhs.shtml)
    - Establishes locations for storing important data
    - Locations include
        - Real directories (persistent data on disks)
        - Virtual directories (loaded in memory)
            - Grant access to kernel subsystem data (e.g., running processes, memory use, hardware configuration)
            - Used by commands to monitor and manage system data
- Important Data on a Linux System
    - Programs
        - Executable files containing instructions for the processor
        - Can be
            - Binary files
            - Text files (called scripts)
    - Configuration files
        - Control the operation of a program
        - Traditionally stored as text files
        - Various styles of representing configuration data exist

#### Where Binary Files are Stored
- Binary (Executable) Files
  - Stored in directories within the Linux directory structure
  - These directories all branch from the root directory (`/`)

##### Three-Tier Structure
- First Tier (`/`)
    - Location
        - Root directory (`/`)
   - Purpose
        - Contains essential programs
    - Access
        - Necessary for basic system functions
        - Particularly in *single-user mode*
            - Only the root user has access
            - Typically for maintenance or recovery tasks

- Second Tier (`/usr`)
    - Location
        - `/usr` directory
    - Purpose
        - Stores most of the systemâ€™s multi-user programs
    - Access
        - Used during normal multi-user operations
            - System is functioning with multiple users logged in

- Third Tier (`/usr/local`)
    - Location
        - `/usr/local` directory
    - Purpose
        - Houses software that is not provided by the distribution and has been compiled or installed locally by the user
    - Access
        - Typically contains custom or user-compiled software, providing a space for applications not managed by the system's package manager

##### Key Points
- Each tier has a specific purpose based on the level of access and functionality needed
- The first tier ensures critical programs are available even in limited or recovery modes
- The second tier supports the typical operations of a multi-user system
- The third tier allows for flexibility and customization by the user, separating system-provided software from user-installed software

##### Typical locations

|Location|Contents|Examples|
|--------|--------|--------|
| `/sbin` | Essential binaries for system administration | `parted`, `ip` |
| `/bin` | Essential binaries for all users | `ls`, `mv`, `mkdir` |
| `/usr/sbin` | Binaries for system administration | `deluser`, `groupadd` |
| `/usr/bin` | Most executable files used by all users  | `free`, `pstree`, `sudo`, `man` |
| `/usr/local/sbin` | Locally installed programs for sys admin not managed by the package manager | N/A |
| `/usr/local/bin` | Locally installed programs for regular users | N/A |
| `/opt` | Optional third-party applications | N/A |
| `/home/$USER/bin` | User-specific programs | User-created scripts or binaries |
| `/home/$USER/.local/bin` | User-specific programs, often installed via pip or other user-level package managers | User-installed binaries or scripts |


- Symbolic links
    - Some distros replace `/bin` and `/sbin` with symbolic links redirecting to `/usr/bin` and `/usr/sbin`
- Information gathering
    - `echo $PATH`
        - Displays current search path for executable files in the terminal
        - Displays all directories where system looks for executable programs
        - `$PATH` variable contains colon-separated list of directories
            - Shell searches list when you type a command
    - `which`
        - Locates the full path of an executable file for a given command.
        - It searches through the directories listed in the $PATH variable
        - Returns the first matching executable's path

#### Where Configuration Files are Stored
- `/etc` 
    - Originally a catch-all for misc files
    - Now main folder for configuration files/programs
        - Config files usually
            - Local
            - Plain text (opposed to binary)
            - Control operation of a program
- Naming conventions found in `/etc`
    - Naming convention patterns help identify purpose or association of files within the system
    - `.conf` for general configuration files
        - `resolv.conf`
            - For DNS resolver configuration
        - `sysctl.conf`
            - For kernel parameters 
            - Allows kernel mods without recompiling 
    - *ad hoc* for temporary or no file extension 
        - `group`
            - System group database
        - `hostname`
            - Name of the host computer
        - `hosts`
            - List of IP addresses and their hostname translations
        - `profile`
            - System wide configuration file for Bash
        - `shadow`
            - Encrypted file for user passwords
        - `passwd`
            - System user user database
            - 7 fields separated by colons providing user info
                - Username
                - Password placeholder (`x` or `*`)
                - User ID (UID)
                - Group ID (GID)
                - GECOS
                    - User real world information
                - Home directory 
                - Login shell
                    - Can be changed with `chsh`
    - `.*+rc` for run commands
        - Used to initialize settings or customize programs and shell behavior 
        - Help automate repetitive tasks
        - Ensure consistent environment 
        - Usually shell scripts or plain text defining
            - Environment variables
            - Aliases
            - Functions
            - etc.
        - `~/.bashrc`
            - Configures enviro for Bash sessions
        - `~/.vimrc`
            - Customizes Vim text editor behavior
        - `~/etc/bash.bashrc`
            - Applies configs for all users' Bash shells
        - `alias` command adds shortcut in Bash
            - `alias ll='ls -la'`
    - `.d` for directories containing multiple config files or scripts related to specific service or task
        - Modularity
            - Facilitates easier maintenance and organization of config files
        - Security
            - Reduces risk of errors in critical config files
        - Flexibility
            - Enables selective overrides or additions to default configs by simply adding new files to `.d` directory
            - Allows for different applications to house separate config files for same service
- `HOME` configuration dotfiles
    - Hidden configuration files in user home directory 
    - Files beginning with `.` are considered hidden
        - Referred to as dotfiles
    - Store user-specific configs and settings from programs or shells
    - Allow users to customize environment
    - `.bash_history`
        - Stores history of commands typed into shell
    - `.bash_logout`
        - Script of commands executed on shell logout 
    - `.bashrc`
        - Initialization script for non-login Bash shells
            - e.g. when you open a terminal as opposed to initializing your computer session by logging in with credentials
    - `.profile`
        - Initialization script for login shells 
    - `.gitconfig`
        - Stores configs for Git such as username, email, aliases for Git commands
    - `.ssh`
        - Directory containing SSH-related files such as keys, known hosts, configs for sessions

#### The Linux Kernel and Process Management 
- Kernel initialization
    - The Linux kernel is the core of the operating system
        - Must be loaded into a protected area of memory before any processes can run
        - Typically done during the boot process
- Process initialization
    - After the kernel is loaded
    - First process to start has Process ID (PID) 1
    - Today, most commonly systemd
        - Serves as the system and service manager in many Linux distros
- Process chain
    - systemd (or the PID 1 process)
        - Begins the process of launching and managing other processes
    - Each process may start one or more child processes
        - Creates hierarchical structure of running processes on the system
- Kernel's role
    - Once processes are running, the Linux kernel manages system resources for them, including:
        - Hardware resources
        - Memory management (RAM allocation)
        - File and disk access
        - Networking and I/O operations
- Historical context
    - Previously, Linux systems used /sbin/init as the first process
        - Part of the System V Init system manager
    - /sbin/init may still exist on many systems for compatibility purposes
- `/boot`
    - Kernel resides in `/boot` with other boot-related files
    - Names include version components 
        - Kernel version
        - Major revision
        - Minor revision
        - Patch number
    - `config-4.9.0-9-amd64`
        - Configuration settings 
            - Options and modules
                - Compiled along with kernel
    - `initrd.img-e.9.0-9-amd64`
        - Initial RAM disk image 
            - Helps startup processes
            - Loads temp root filesystem into memory
    - `System-map-4.9.0-9-amd64`
        - Also `System-map` or `System.map`
        - Contains memory address location for kernel symbol names
        - Each time kernel rebuilds, file's contents will change as memory locations could be different
        - Kernel uses this file to lookup memory address locations for particular kernel symbols
    - `vmlinuz-4.9.0-9-amd64`
        - The kernel in a self-extracting, space-saving, compressed format
    - `efi`
        - Contains files required for system's UEFI firmware to boot OS
        - Inside you will find bootloaders and other necessary files for booting 
        - Common bootloaders include 
            - GRUB (Grand Unified Bootloader)
            - shim (used for secure boot)
    - `GRUB`
        - GNU Grand Unified Bootloader
        - Loads and transfers control to OS's kernel during boot process 
        - Allows user to choose OS or kernel to boot into
        - Supports additional features
            - Recovery mode
            - Kernel parameters
            - Command line access 
- `/proc`
    - Virtual filesystem providing a window into the kernel and running processes
    - Does not contain data stored on disk
    - Represents real-time system information
        - Generates dynamically to reflect system state
    - Each container in /proc generates data on system or processes
    - `/proc/cmdline`
        - Stores strings passed to kernel on boot
    - `/proc/modules`
        - Shows list of modules loaded into kernel
    - `/proc/sys`
        - Kernel configuration settings categorized into subdirectories based on functionality
            - Categories incl:
                - `net`: Networking parameters
                - `vm`: Virtual memory management settings
                - `fs`: File system related settings
                - `kernel`: General kernel parameters
        - Contains files that can be read of modified to dynamically change system behavior
            - Influence various aspects of system performance, security, and networking without reboot
        - Changes made directly to `/proc/sys` are not persistent
            - Save in system configuration file for persistence






---
{% include bttnav.html %}